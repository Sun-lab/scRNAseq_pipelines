cluster_tag_seq=1:17
file_tag="3k10"
###########functions#############
setwd("/Volumes/SpecialPass/fh_data/Data_PRJNA434002/")
#input phenotype
if(is.na(unlist(strsplit(file_tag,"k"))[2])){
tmeta=meta=read.table("../Data_PRJNA434002/meta.tsv",header = TRUE, sep = "\t")
}
if(!is.na(unlist(strsplit(file_tag,"k"))[2])){
tmeta=readRDS(paste0("../Data_PRJNA434002/meta",unlist(strsplit(file_tag,"k"))[2],".rds"))
}
total_individual=unique(tmeta$individual)
48919/2
eval(parse("PFC_L2_3"))
cell_info=readRDS("meta10.rds")
iInfo = distinct(cell_info[,3:12])
set.seed(101)
N<-500; J<-5000 #number of cells and genes
sz<-rgamma(N,shape=10,rate=10)
summary(sz)
mu1<-.1; mu2<-5; mu3a<-1; mu3b<-9
Y1<-replicate(J/2,rnbinom(N,size=.1,mu=mu1*sz))
Y2<-replicate(J/4,rpois(N,mu2*sz))
Y3a<-replicate(J/4,rnbinom(N/2,size=.1,mu=mu3a*sz[1:(N/2)]))
Y3b<-replicate(J/4,rnbinom(N/2,size=.1,mu=mu3b*sz[((N/2)+1):N]))
Y3<-rbind(Y3a,Y3b)
Y<-t(cbind(Y1,Y2,Y3))
summary(colSums(Y))
summary(1-colMeans(Y>0))
max(Y)
gtype<-c(rep("low",J/2),rep(c("high_const","high_var"),each=J/4))
rm<-rowMeans(Y)
summary(rm)
boxplot(rm~gtype) #ensure high_var and high_const have same row means
gm<-data.frame(gtype=gtype)
cm<-data.frame(celltype=rep(c("a","b"),each=N/2),nUMI=colSums(Y))
View(Y)
